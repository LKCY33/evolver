# 2026-01-31 Memory Log

## System Maintenance
- **Critical Fix (Memory Subsystem):**
  - **Issue:** Gemini batch status `UNKNOWN` was causing infinite blocking loops in the memory subsystem, leading to "read but no reply" behavior on Feishu.
  - **Fix:** Updated `openclaw.json` to set `memory.write.mode` to `"best-effort"` and added timeouts (`10000`ms write, `15000`ms poll). This prevents memory writes from blocking the critical reply path.
  - **Status:** Config applied. User instructed to run `openclaw gateway restart`.

- **Skill Upgrade (Feishu Card):**
  - **Issue:** `feishu-card` skill was hardcoded to send only to Master's Open ID, failing in group chats.
  - **Fix:** Updated `skills/feishu-card/send.js` to dynamically detect target type. If target starts with `oc_`, it uses `chat_id`; otherwise `open_id`.
  - **Verification:** Successfully sent a test card to group `oc_895e62addd9be95a2c736cd2bb705b1d`.
  - **Policy Update:** Updated `MEMORY.md` to explicitly state: "ALWAYS detect context. If in group (`oc_...`), use group ID."

- **Skill Upgrade (Mind Blow):**
  - **Action:** Updated `skills/mind-blow/blow.js` to also support dynamic targeting (group vs DM) so it can be used in group chats.

## Task Execution
- **Feishu Doc Analysis:**
  - **Task:** Analyzed a Feishu Bitable/Wiki about game bugs (`https://autogame.feishu.cn/wiki/...`).
  - **Action:** Used `feishu-doc` skill to fetch content, then categorized bugs into "AI Logic", "Item Interaction", and "Visual Glitches".
  - **Output:** Sent a structured Feishu Card report to the group.

## Knowledge
- **Feishu Menu:** Learned about "Robot Custom Menu" (Switchable vs Floating). User enabled event callbacks.
  - **Plan:** Need to implement logic to handle `menu_event` callbacks in the future (currently just acknowledged).
- **Gossip Protocol (New):**
  - **Trigger:** Any "gossip" or "intelligence" report.
  - **Action:** Send ONLY to Master (`ou_cdc63fe05e88c580aedead04d851fc04`).
  - **Rule:** Keep secret from all other users.
- **Mind Blow Protocol (New):**
  - **Trigger:** Keyword "mind blow".
  - **Action:** Execute `mind-blow` skill.
  - **Default:** Intensity `medium` if unspecified.
